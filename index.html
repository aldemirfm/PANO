<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Fatih Mehmet Aldemir Panosu</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
html, body { 
  width:100%; 
  height:100%;
}
body {
  display:flex;
  flex-direction:column;
  font-family:"Segoe UI",Arial,sans-serif;
  background:#f3f6fa;
  overflow:hidden;
  height: 100vh;
}

/* HEADER */
header {
  flex:0 0 10%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 20px;
  background: linear-gradient(90deg,#2f26bf, #0D1A36);
  box-shadow:0 2px 4px rgba(0,0,0,0.08);
}
#headerLeft { flex:1; font-size:1.8em; font-weight:900; color:#fff; text-align:left; }
#headerCenter { flex:0 0 auto; display:flex; justify-content:center; align-items:center; }
#schoolLogo { max-height:500px; max-width:500px; object-fit:contain; }
#headerRight { flex:1; display:flex; align-items:center; justify-content:flex-end; gap:10px; }
#dayMonth { font-size:3em; font-weight:700; color:#FFFFFF; }
#time { font-size:4em; font-weight:800; color:#FFFFFF; }

/* MAIN GRID - 4x4 */
main {
  flex:1 1 90%;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(4, 1fr);
  gap: 5px;
  padding: 5px;
  align-items: stretch;
}

/* BOX STYLE */
.box {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  text-align: center;
  border-radius: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  padding: 12px;
  font-size: 1em;
  font-weight: 700;
  width: 100%;
  height: 100%;
  margin: 0;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.box:hover { transform:translateY(-4px); box-shadow:0px 8px 16px rgba(0,0,0,0.12); }

.boxTitle {
  width: 100%;
  text-align: center;
  font-size: 2em;
  font-weight: 800;
  padding-bottom: 6px;
  margin-bottom: 8px;
  border-bottom: 2px solid rgba(255,255,255,0.4);
}

/* KUTU POZİSYONLARI - 4x4 GRID */

/* 1. SATIR */
#nobetci {
  grid-column: 1;
  grid-row: 1 / 3;
  background: linear-gradient(180deg,#000000,#202d58);
}

/* WEB SİTESİ KUTUSU */
#websiteBox {
  grid-column: 2 / 4;
  grid-row: 1 / 4;
  background: linear-gradient(0deg, #4903C3, #16013B);
  display: flex;
  flex-direction: column;
  padding: 0;
  border-radius: 15px;
  overflow: hidden;
  position: relative; /* Ekledim */
}

#webFrame {
  width: 100%; /* Tam genişlik */
  height: 100%; /* Tam yükseklik */
  border: none;
  background: white;
  /* Transform'ları kaldırdım - tam kaplasın */
}

/* Başlık stilleri */
#websiteBox .boxTitle {
  padding: 12px;
  margin: 0;
  border-bottom: 2px solid rgba(255,255,255,0.4);
}

/* 2. SATIR */
#examCountdown {
  grid-column: 1;
  grid-row: 3 / 5; 
  background: linear-gradient(0deg, #ff0000,#000000);
}

#weatherBox {
  grid-column: 4;
  grid-row: 1 / 3;
  background: linear-gradient(0deg, #000000, #474747);
  position: relative;
  overflow: hidden;
}

/* 3. SATIR */
#solkutu {
  grid-column: 2 / 4;
  grid-row: 4;
  background: linear-gradient(180deg, #338e06, #6eeba5);
}

#menuBox {
  grid-column: 4;
  grid-row: 3 / 5;
  background: linear-gradient(180deg, #383838,#00f904);
}

/* İÇERİK STİLLERİ */

#nobetciList { 
  text-align: left; 
  font-size: 0.9em; }

.nobetPlace { 
  color: #ffd63e;
  font-weight: 700;
  font-size: 1.8em;
  display:inline-block;
  width:120px;
  vertical-align: top;
}
.nobetTeacher { 
  color: #ffffff;
  font-size: 1.8em;
  display:inline-block;
}
.nobetRow { 
  margin-bottom: 5px; 
  border-bottom: 1px solid rgba(255,255,255,0.2);
}

/* EN ALTTAKİ ÇİZGİYİ KALDIR */
.nobetRow:last-child {
  border-bottom: none;
}
#nobetci .boxTitle {
  color: #ffd63e; /* Sarı - nöbet yerleriyle aynı renk */
  font-size: 1.8em
}
.announcementText {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  width: 100%;
  height: 100%;
  font-size: 3em;
  font-weight: 700;
}
#announcementBox1 .boxTitle {
  color: #ffd63e; /* Sarı - nöbet yerleriyle aynı renk */
  font-size: 1.8em
}
/* HAVA DURUMU */
#currentWeather { 
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 20px;
  width: 100%;
  height: 60%;
  position: relative;
  z-index: 2;
}
#weatherBox .boxTitle {
  color: #ffd63e; /* Sarı - nöbet yerleriyle aynı renk */
  font-size: 1.8em;
  position: relative;
  z-index: 2;
}
#currentWeather img { 
  width: 150px; 
  height: 150px; 
  margin-right: 30px; /* İkona sağ sol kaydırma */
  /* ANİMASYONLARI EKLEYİN */
  animation: weatherIconMove 3s ease-in-out infinite,
             weatherIconGlow 3s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(0, 140, 255, 0.8));
  position: relative;
  z-index: 2;
}

/* Animasyon keyframes'leri */
@keyframes weatherIconMove {
  0%   { transform: translateY(0px); }
  50%  { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
}

@keyframes weatherIconGlow {
  0%   { filter: drop-shadow(0 0 6px rgba(0, 140, 255, .5)); }
  50%  { filter: drop-shadow(0 0 22px rgba(0, 140, 255, .95)); }
  100% { filter: drop-shadow(0 0 6px rgba(0, 140, 255, .5)); }
}

#temp {
  font-size: 3em;
  font-weight: 900;
  color: #ffffff;
  position: relative;
  z-index: 2;
}

#desc {
  font-size: 3em;
  font-weight: 700;
  color: #ffffff;
  position: relative;
  z-index: 2;
}

.forecast { 
  display:flex; 
  justify-content:space-around; 
  width:100%;
  height: 40%;
  font-size: 2em;
  position: relative;
  z-index: 2;
}
.forecast .day { 
display:flex; 
flex-direction:column; 
align-items:center; 
padding:5px; }

.forecast .dayName { font-weight:700; 
font-size:1em; 
margin-bottom:3px; 
color:#ffffff; }

.forecast .temp { 
font-size:1.1em; 
font-weight:700; 
color:#ffffff; }

/* SINAV GERİ SAYIM */
#examCountdown {
  display: flex; 
  flex-direction: row;  /* Yatay düzen */
  justify-content: space-between;  /* Sol ve sağa yasla */
  align-items: flex-start;
  gap: 10px; 
  height: 100%;
  padding: 0 20px;  /* Yanlardan boşluk */
}
/* YKS ve LGS arasına dikey çizgi */
.countdownItem:first-child {
  border-right: 3px solid rgba(255,255,255,0.5); /* Dikey çizgi */
  padding-right: 20px; /* Çizgi ile içerik arası boşluk */
}

.countdownItem:last-child {
  padding-left: 20px; /* Çizgi ile içerik arası boşluk */
}
/* TÜM GERİ SAYIM SAYILARI YANIP SÖNSÜN */
.countdownValue {
  font-size: 1.8em;
  font-weight: 900;
  color: #00ff00;
  animation: blink 1.5s infinite;
  margin: 5px 0;
}

@keyframes blink {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}
.countdownItem {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 0;
  flex: 1;  /* Eşit genişlik */
}

/* YKS sola yaslı */
#examCountdown .countdownItem:first-child {
  align-items: flex;  /* Sola hizala */
}

/* LGS sağa yaslı */
#examCountdown .countdownItem:last-child {
  align-items: flex;  /* Sağa hizala */
}

.countdownTitle {
  font-size: 3em;
  font-weight: 800;
  color: white;
  margin-bottom: 5px;
}

.countdownValue {
  font-size: 4em;
  font-weight: 900;
  color: #00ff00;
}

.countdownLabel {
  font-size: 2em;
  font-weight: 700;
  color: white;
}

/* YEMEK LİSTESİ */
#menuList {
  text-align: center;
  width: 100%;
  height: 100%;
  font-size: 2.1em;
  padding: 10px;
}
#menuBox .boxTitle {
  color: #ffd63e; /* Sarı - nöbet yerleriyle aynı renk */
  font-size: 1.8em
}
.menu-row {
  margin-bottom: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.6) !important;
}

/* EN ALTTAKİ ÇİZGİYİ KALDIR */
.menu-row:last-child {
  border-bottom: none !important;
  margin-bottom: 0;
  padding-bottom: 0;
}

/* KÜÇÜK KUTULAR İÇİN */
#box1Content {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  width: 100%;
  height: 100%;
  font-size: 1.8em;
  font-weight: 700;
}

/* GİZLİ BAŞLIKLAR */
#solkutu .boxTitle {
  display: none;
}

/* MARQUEE */
#marquee {
  flex: 0 0 8%;
  min-height: 60px;
  background: #003366;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  font-size: 4em;
  font-weight: 800;
  letter-spacing: 1px;
  position: relative;
  z-index: 1000;
}

#marquee span {
  position: absolute;
  white-space: nowrap;
  animation: scrollText 10s linear infinite;
}

@keyframes scrollText {
  from { left: 100%; }
  to { left: -100%; }
}

/* HAVA DURUMU ANİMASYONLARI */
#weatherAnimation {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
}

/* YAĞMUR ANİMASYONU */
.rain-drop {
    position: absolute;
    top: -20px;
    width: 2px;
    height: 15px;
    background: linear-gradient(to bottom, transparent, #87CEEB);
    animation: rain-fall linear infinite;
    border-radius: 50%;
}

@keyframes rain-fall {
    0% {
        transform: translateY(-20px);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        transform: translateY(100vh);
        opacity: 0;
    }
}

/* KAR ANİMASYONU */
.snow-flake {
    position: absolute;
    top: -10px;
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    animation: snow-fall linear infinite;
    filter: blur(0.5px);
}

@keyframes snow-fall {
    0% {
        transform: translateY(-10px) translateX(0);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) translateX(20px);
        opacity: 0;
    }
}

/* GÜNEŞLİ ANİMASYONU */
.sun-animation {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background: radial-gradient(circle, #FFD700, #FFA500);
    border-radius: 50%;
    animation: sun-pulse 3s ease-in-out infinite;
    box-shadow: 0 0 20px #FFD700, 0 0 40px #FFA500;
}

@keyframes sun-pulse {
    0%, 100% {
        transform: scale(1);
        opacity: 0.8;
    }
    50% {
        transform: scale(1.1);
        opacity: 1;
    }
}

/* BULUTLU ANİMASYONU */
.cloud {
    position: absolute;
    background: rgba(255, 255, 255, 0.8);
    border-radius: 50%;
    animation: cloud-move linear infinite;
}

.cloud::before, .cloud::after {
    content: '';
    position: absolute;
    background: rgba(255, 255, 255, 0.8);
    border-radius: 50%;
}

@keyframes cloud-move {
    0% {
        transform: translateX(-100px);
    }
    100% {
        transform: translateX(calc(100vw + 100px));
    }
}

/* SİSLİ ANİMASYONU */
.fog {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent
    );
    animation: fog-move 10s linear infinite;
}

@keyframes fog-move {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

</style>
</head>
<body>

<header>
  <div id="headerLeft">FATİH MEHMET ALDEMİR<br>PANOSU</div>
  <div id="headerCenter"><img src="okul_logo.png" alt="Okul Logosu" id="schoolLogo"></div>
  <div id="headerRight">
    <span id="dayMonth"></span>
    <span id="time"></span>
  </div>
</header>

<main>
  <!-- 1. SATIR -->
  <div class="box" id="nobetci">
    <div class="boxTitle">NÖBETÇİ ÖĞRETMENLER</div>
    <div id="nobetciList">Yükleniyor...</div>
  </div>

<div class="box" id="websiteBox">
  <iframe id="webFrame" src="https://develiihl.meb.k12.tr/" frameborder="0"></iframe>
</div>

  <!-- 2. SATIR -->
  <div class="box" id="examCountdown">
    <div class="countdownItem">
      <div class="countdownTitle">YKS</div>
      <div class="countdownValue" id="yksCountdownNum">--</div>
      <div class="countdownLabel">GÜN</div>
      <div class="countdownValue" id="yksCountdownHour">--</div>
      <div class="countdownLabel">SAAT</div>
    </div>
    <div class="countdownItem">
      <div class="countdownTitle">LGS</div>
      <div class="countdownValue" id="lgsCountdownNum">--</div>
      <div class="countdownLabel">GÜN</div>
      <div class="countdownValue" id="lgsCountdownHour">--</div>
      <div class="countdownLabel">SAAT</div>
    </div>
  </div>

  <div class="box" id="weatherBox">
    <div class="boxTitle">HAVA DURUMU</div>
    <div id="weatherAnimation"></div>
    <div id="currentWeather">
      <img id="weatherIcon" src="" alt="icon">
      <div>
        <div id="temp">--°C</div>
        <div id="desc">Yükleniyor...</div>
      </div>
    </div>
    <div class="forecast">
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
    </div>
  </div>

  <!-- 3. SATIR -->
  <div class="box" id="solkutu">
    <div id="box1Content">Yükleniyor...</div>
  </div>

  <div class="box" id="menuBox">
    <div class="boxTitle">YEMEK LİSTESİ</div>
    <div id="menuList">Yükleniyor...</div>
  </div>


</main>

<!-- Marquee -->
<div id="marquee"><span>HOŞ GELDİNİZ</span></div>

<script>
// TAM EKRAN
function enableFullScreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
}
window.addEventListener("click", enableFullScreen);

// ------------------ Tarih & Saat ------------------
function updateDateTime() {
  const now = new Date();
  const days = ["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"];
  const months = ["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım"];
  
  const dayName = days[now.getDay()];
  const dateNum = now.getDate();
  const monthName = months[now.getMonth()];
  const hours = now.getHours().toString().padStart(2,"0");
  const minutes = now.getMinutes().toString().padStart(2,"0");
  
  document.getElementById("dayMonth").innerText = `${dayName}, ${dateNum} ${monthName}`;
  document.getElementById("time").innerText = `${hours}:${minutes}`;
}
setInterval(updateDateTime, 1000);
updateDateTime();

// ------------------ YKS & LGS ------------------
function countdown(target, numEl, hourEl) {
  const now = new Date();
  const diff = target - now;
  const days = Math.floor(diff / (1000*60*60*24));
  const hours = Math.floor((diff / (1000*60*60)) % 24);
  document.getElementById(numEl).innerText = days;
  document.getElementById(hourEl).innerText = hours;
}
setInterval(()=>{
  countdown(new Date("2026-06-20"), "yksCountdownNum","yksCountdownHour");
  countdown(new Date("2026-06-01"), "lgsCountdownNum","lgsCountdownHour");
}, 1000);

// ------------------ HAVA DURUMU ANİMASYON SİSTEMİ ------------------
class WeatherAnimation {
    constructor() {
        this.container = document.getElementById('weatherAnimation');
        this.currentWeather = '';
    }

    // Hava durumunu ayarla ve animasyonu başlat
    setWeather(weatherType) {
        this.clearAnimation();
        this.currentWeather = weatherType.toLowerCase();
        
        switch(this.currentWeather) {
            case 'rain':
            case 'rainy':
            case 'showers':
            case 'drizzle':
                this.createRain();
                break;
            case 'snow':
            case 'snowy':
                this.createSnow();
                break;
            case 'clear':
            case 'sunny':
                this.createSunny();
                break;
            case 'clouds':
            case 'cloudy':
                this.createCloudy();
                break;
            case 'fog':
            case 'mist':
            case 'haze':
                this.createFog();
                break;
            case 'thunderstorm':
                this.createThunderstorm();
                break;
            default:
                this.createCloudy(); // Varsayılan
        }
    }

    // Yağmur animasyonu
    createRain() {
        for (let i = 0; i < 100; i++) {
            const drop = document.createElement('div');
            drop.className = 'rain-drop';
            drop.style.left = `${Math.random() * 100}%`;
            drop.style.animationDuration = `${0.5 + Math.random() * 0.5}s`;
            drop.style.animationDelay = `${Math.random() * 2}s`;
            this.container.appendChild(drop);
			drop.style.width = '2px';
            drop.style.height = '30px';
        }
    }

    // Kar animasyonu
    createSnow() {
        for (let i = 0; i < 30; i++) {
            const snow = document.createElement('div');
            snow.className = 'snow-flake';
            snow.style.left = `${Math.random() * 100}%`;
            snow.style.animationDuration = `${3 + Math.random() * 5}s`;
            snow.style.animationDelay = `${Math.random() * 5}s`;
            snow.style.width = `${3 + Math.random() * 4}px`;
            snow.style.height = snow.style.width;
            this.container.appendChild(snow);
        }
    }

    // Güneşli animasyon
    createSunny() {
        const sun = document.createElement('div');
        sun.className = 'sun-animation';
        this.container.appendChild(sun);
    }

    // Bulutlu animasyon
    createCloudy() {
        for (let i = 0; i < 3; i++) {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            cloud.style.top = `${20 + Math.random() * 50}%`;
            cloud.style.width = `${40 + Math.random() * 30}px`;
            cloud.style.height = `${20 + Math.random() * 15}px`;
            cloud.style.animationDuration = `${20 + Math.random() * 20}s`;
            cloud.style.animationDelay = `${Math.random() * 10}s`;
            cloud.style.opacity = '0.7';
            
            this.container.appendChild(cloud);
        }
    }

    // Sis animasyonu
    createFog() {
        const fog = document.createElement('div');
        fog.className = 'fog';
        this.container.appendChild(fog);
    }

    // Fırtına animasyonu (yağmur + şimşek efekti)
    createThunderstorm() {
        this.createRain();
        
        // Şimşek efekti
        setInterval(() => {
            if (Math.random() > 0.7) {
                this.container.style.backgroundColor = 'rgba(255, 255, 255, 0.3)';
                setTimeout(() => {
                    this.container.style.backgroundColor = 'transparent';
                }, 100);
            }
        }, 2000);
    }

    // Animasyonu temizle
    clearAnimation() {
        this.container.innerHTML = '';
        this.container.style.backgroundColor = 'transparent';
    }
}

// Hava durumu animasyon sistemini başlat
const weatherAnim = new WeatherAnimation();

// ------------------ HAVA DURUMU VERİSİ ------------------
async function loadWeather() {
  const apiKey = "c5155ad22a417a8b1068985b43425bb3";
  const city = "Develi,TR";

  try {
    const currentRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=tr`);
    const currentData = await currentRes.json();
    
    document.getElementById("temp").innerText = Math.round(currentData.main.temp) + "°C";
    document.getElementById("desc").innerText = currentData.weather[0].description.toUpperCase();
    
    const iconMap = {
      Clear: "sunny.png",
      Clouds: "cloudy.png",
      Rain: "rainy.png",
      Snow: "snowy.png",
      Drizzle: "drizzle.png",
      Thunderstorm: "thunderstorm.png"
    };

    const weatherMain = currentData.weather[0].main;
    const iconFile = iconMap[weatherMain] || "sunny.png";
    document.getElementById("weatherIcon").src = "icons/weather/" + iconFile;

    // Hava durumuna göre animasyonu başlat
    weatherAnim.setWeather(weatherMain);

  } catch {
    document.getElementById("temp").innerText = "--";
    document.getElementById("desc").innerText = "❌ Veri alınamadı";
    weatherAnim.setWeather('cloudy'); // Varsayılan animasyon
  }

  try {
    const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric&lang=tr`);
    const forecastData = await forecastRes.json();
    const daysMap = ["Paz","Pzt","Sal","Çar","Per","Cum","Cts"];
    const dailyForecast = [];
    const addedDates = new Set();

    for (let item of forecastData.list) {
      const date = new Date(item.dt_txt);
      const dateKey = date.getFullYear() + "-" + (date.getMonth()+1) + "-" + date.getDate();
      if (!addedDates.has(dateKey)) {
        addedDates.add(dateKey);
        dailyForecast.push({
          dayName: daysMap[date.getDay()],
          temp: Math.round(item.main.temp)
        });
      }
      if (dailyForecast.length >= 3) break;
    }

    const forecastContainer = document.querySelector("#weatherBox .forecast");
    forecastContainer.innerHTML = dailyForecast.map(d => `
      <div class="day">
        <div class="dayName">${d.dayName}</div>
        <div class="temp">${d.temp}°C</div>
      </div>
    `).join("");

  } catch {
    document.querySelector("#weatherBox .forecast").innerHTML = "<div style='color:red'>❌ Veri alınamadı</div>";
  }
}

function updateWeatherHourly() {
  const now = new Date();
  const delay = (60 - now.getMinutes())*60*1000 - now.getSeconds()*1000;
  setTimeout(() => {
    loadWeather();
    setInterval(loadWeather, 3600000);
  }, delay);
}
loadWeather();
updateWeatherHourly();

// ------------------ NÖBETÇİ ÖĞRETMEN ------------------
const sheetURL = "https://docs.google.com/spreadsheets/d/1oF2cT3UkMBW4c2PgVIsncCYfHV1dJeoB_fS68c8pU1c/gviz/tq?tqx=out:json&gid=0";

function loadDutyTeachers() {
  fetch(sheetURL)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1));
      const rows = json.table.rows;

      const days = [null,"PAZARTESİ","SALI","ÇARŞAMBA","PERŞEMBE","CUMA",null];
      const today = days[new Date().getDay()];

      const headers = rows[0].c.map(h => h?.v?.toString().toUpperCase() || "");
      const colIndex = headers.indexOf(today);
      if(colIndex === -1) {
        document.getElementById("nobetciList").innerHTML = "❌ Bugün yok";
        return;
      }

      let output = "";

      for (let i = 1; i < rows.length; i++) {
        const place = rows[i].c[0]?.v || "";
        const teacherCell = rows[i].c[colIndex]?.v || "";
        if (!place && !teacherCell) continue;

        const teachers = teacherCell.split("\n").filter(t => t.trim() !== "");

        output += `<div class="nobetRow">`;
        if(place) output += `<span class="nobetPlace">${place}:</span> `;
        if(teachers.length) {
          output += `<span class="nobetTeacher">`;
          teachers.forEach(t => {
            output += `${t}<br>`;
          });
          output += `</span>`;
        }
        output += `</div>`;
      }

      document.getElementById("nobetciList").innerHTML = output || "BUGÜN NÖBET YOK";
    })
    .catch(err => {
      console.error(err);
      document.getElementById("nobetciList").innerHTML = "❌ Veri alınamadı";
    });
}

loadDutyTeachers();
setInterval(loadDutyTeachers, 30000);


// ------------------ YEMEK LİSTESİ ------------------
const menuSheetURL="https://docs.google.com/spreadsheets/d/1ps4RgDTOscAE8FVLU0mWl9hJpnK2XEMlHa8C7c7e9pw/gviz/tq?tqx=out:json&gid=0";

function loadMenu(){
    const menuListElement = document.getElementById("menuList");
    const now = new Date();
    const year = now.getFullYear();
    const month = (now.getMonth() + 1).toString().padStart(2, "0");
    const day = now.getDate().toString().padStart(2, "0");
    
    const todayDateString = `${day}.${month}.${year}`;

    fetch(menuSheetURL)
        .then(res => res.text())
        .then(text => {
            const jsonText = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
            const json = JSON.parse(jsonText);
            const rows = json.table.rows;
            
            let output = "Bu güne ait yemek listesi yok.";
            let found = false;

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i].c;
                const sheetDateCell = row[0]?.f || row[0]?.v;
                
                if (!sheetDateCell) continue;
                
                let sheetDateString = null;

                if (typeof sheetDateCell === 'string' && sheetDateCell.startsWith('Date(')) {
                    const parts = sheetDateCell.match(/\d+/g);
                    if (parts && parts.length >= 3) {
                        const sheetYear = parts[0];
                        const sheetMonth = (parseInt(parts[1]) + 1).toString().padStart(2, "0");
                        const sheetDay = parts[2].toString().padStart(2, "0");
                        sheetDateString = `${sheetDay}.${sheetMonth}.${sheetYear}`;
                    }
                } else if (typeof sheetDateCell === 'string') {
                    sheetDateString = sheetDateCell.trim();
                }

                if (sheetDateString === todayDateString) {
                    output = row[1]?.v || "Yemek listesi boş.";
                    found = true;
                    break;
                }
            }
            
            // YEMEK LİSTESİNİ FORMATLA - AYIRICI ÇİZGİ İLE
            if (found && output !== "Yemek listesi boş.") {
                const foods = output.split("\n").filter(food => food.trim() !== "");
                let formattedOutput = '';
                
                foods.forEach((food, index) => {
                    const isLast = index === foods.length - 1;
                    formattedOutput += `<div class="menu-row">${food}</div>`;
                });
                
                menuListElement.innerHTML = formattedOutput;
            } else {
                menuListElement.innerHTML = `<div class="menu-row">${output}</div>`;
            }
        })
        .catch(err => {
            console.error("Yemek Listesi Hatası:", err);
            menuListElement.innerHTML = '<div class="menu-row" style="border-bottom: 3px solid red;">❌ Yemek listesi alınamadı</div>';
        });
}

loadMenu();
setInterval(loadMenu, 3600000);

// ------------------ GÜNLÜK SÖZLER ------------------
const quoteSheetURL = "https://docs.google.com/spreadsheets/d/1p4pq-wpK-oFzufueyKOTmYi_Ic2iVcVTyyhXbfpzBhE/gviz/tq?tqx=out:json&gid=0"; 

function loadDailyQuote() {
    const solKutuElement = document.getElementById("box1Content");
    const now = new Date();
    const year = now.getFullYear();
    const month = (now.getMonth() + 1).toString().padStart(2, "0");
    const day = now.getDate().toString().padStart(2, "0");
    
    const todayDateString = `${day}.${month}.${year}`;

    fetch(quoteSheetURL)
        .then(res => res.text())
        .then(text => {
            const jsonText = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
            const json = JSON.parse(jsonText);
            const rows = json.table.rows;
            
            let quote = "Bu güne ait ilham verici söz yok.";

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i].c;
                const sheetDateCell = row[0]?.f || row[0]?.v;
                
                if (!sheetDateCell) continue;
                
                let sheetDateString = null;

                if (typeof sheetDateCell === 'string' && sheetDateCell.startsWith('Date(')) {
                    const parts = sheetDateCell.match(/\d+/g);
                    if (parts && parts.length >= 3) {
                        const sheetYear = parts[0];
                        const sheetMonth = (parseInt(parts[1]) + 1).toString().padStart(2, "0");
                        const sheetDay = parts[2].toString().padStart(2, "0");
                        sheetDateString = `${sheetDay}.${sheetMonth}.${sheetYear}`;
                    }
                } else if (typeof sheetDateCell === 'string') {
                    sheetDateString = sheetDateCell.trim();
                }

                if (sheetDateString === todayDateString) {
                    quote = row[1]?.v || "Söz listesi boş.";
                    break;
                }
            }
            
            solKutuElement.innerHTML = quote.split("\n").join("<br>");
        })
        .catch(err => {
            console.error("Günlük Söz Hatası:", err);
            solKutuElement.innerHTML = "❌ Günlük söz alınamadı";
        });
}

loadDailyQuote();

</script>
</body>
</html>