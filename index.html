<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Fatih Mehmet Aldemir Panosu</title>
<style>
/* === GENEL STİLLER === */
* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

html, body { 
  width: 100%; 
  height: 100%;
}

body {
  display: flex;
  flex-direction: column;
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f3f6fa;
  overflow: hidden;
  height: 100vh;
}

/* === HEADER STİLLERİ === */
header {
  flex: 0 0 10%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
  background: linear-gradient(90deg, #2f26bf, #0D1A36);
  box-shadow: 0 2px 4px rgba(0,0,0,0.08);
}

#headerLeft { 
  flex: 1; 
  font-size: 1.8em; 
  font-weight: 900; 
  color: #fff; 
  text-align: left; 
}

#headerCenter { 
  flex: 0 0 auto; 
  display: flex; 
  justify-content: center; 
  align-items: center; 
}

#schoolLogo { 
  max-height: 500px; 
  max-width: 500px; 
  object-fit: contain; 
}

#headerRight { 
  flex: 1; 
  display: flex; 
  align-items: center; 
  justify-content: flex-end; 
  gap: 10px; 
}

#dayMonth { 
  font-size: 3em; 
  font-weight: 700; 
  color: #FFFFFF; 
}

#time { 
  font-size: 4em; 
  font-weight: 800; 
  color: #FFFFFF; 
}

/* === ANA GRID YAPISI - 4x4 === */
main {
  flex: 1 1 90%;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(4, 1fr);
  gap: 5px;
  padding: 5px;
  align-items: stretch;
}

/* === KUTU STİLLERİ === */
.box {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  text-align: center;
  border-radius: 15px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  padding: 12px;
  font-size: 1em;
  font-weight: 700;
  width: 100%;
  height: 100%;
  margin: 0;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.box:hover { 
  transform: translateY(-4px); 
  box-shadow: 0px 8px 16px rgba(0,0,0,0.12); 
}

.boxTitle {
  width: 100%;
  text-align: center;
  font-size: 2em;
  font-weight: 800;
  padding-bottom: 6px;
  margin-bottom: 8px;
  border-bottom: 2px solid rgba(255,255,255,0.4);
}

/* === KUTU POZİSYONLARI - 4x4 GRID === */

/* 1. SATIR */
#nobetci {
  grid-column: 1;
  grid-row: 1 / 3;
  background: linear-gradient(180deg, #000000, #202d58);
}

/* WEB SİTESİ KUTUSU */
#websiteBox {
  grid-column: 2 / 4;
  grid-row: 1 / 4;
  border-radius: 15px;
  overflow: hidden;
  position: relative;
  padding: 0;
}

#iframeWrapper {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}

#webFrame {
  width: 100%;
  height: calc(100% + 300px);
  position: relative;
  top: -370px;
  border: none;
  display: block;
  transform: scale(1.35);
  image-rendering: -webkit-optimize-contrast; /* Netlik için */
  image-rendering: crisp-edges; /* Kenar netliği */
  filter: contrast(1.1) brightness(1.05); /* Kontrast ve parlaklık */
}

/* 2. SATIR */
#examCountdown {
  grid-column: 1;
  grid-row: 3 / 5; 
  background: linear-gradient(0deg, #ff0000, #000000);
}

#weatherBox {
  grid-column: 4;
  grid-row: 1 / 3;
  background: linear-gradient(0deg, #000000, #474747);
  position: relative;
  overflow: hidden;
}

/* 3. SATIR */
#solkutu {
  grid-column: 2 / 4;
  grid-row: 4;
  background: linear-gradient(180deg, #338e06, #6eeba5);
}

#menuBox {
  grid-column: 4;
  grid-row: 3 / 5;
  background: linear-gradient(180deg, #000000, #1d6915);
}

/* === İÇERİK STİLLERİ === */

/* NÖBETÇİ LİSTESİ */
#nobetciList { 
  text-align: left; 
  font-size: 0.9em; 
}

.nobetPlace { 
  color: #ffd63e;
  font-weight: 700;
  font-size: 1.8em;
  display: inline-block;
  width: 120px;
  vertical-align: top;
}

.nobetTeacher { 
  color: #ffffff;
  font-size: 1.8em;
  display: inline-block;
}

.nobetRow { 
  margin-bottom: 5px; 
  border-bottom: 1px solid rgba(255,255,255,0.2);
}

.nobetRow:last-child {
  border-bottom: none;
}

/* ORTAK BAŞLIK RENGİ */
#nobetci .boxTitle,
#weatherBox .boxTitle,
#menuBox .boxTitle {
  color: #ffd63e;
  font-size: 1.8em;
}

/* DUYURU METİNLERİ */
.announcementText,
#box1Content {
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  width: 100%;
  height: 100%;
  font-weight: 700;
  padding: 10px;
  overflow: hidden;
}

.announcementText {
  font-size: 3em;
}

/* === HAVA DURUMU STİLLERİ === */
#currentWeather { 
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 20px;
  width: 100%;
  height: 60%;
  position: relative;
  z-index: 2;
}

#currentWeather img { 
  width: 200px; 
  height: 200px; 
  margin-right: 30px;
  animation: weatherIconMove 3s ease-in-out infinite,
             weatherIconGlow 3s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(0, 140, 255, 0.8));
  position: relative;
  z-index: 2;
}

/* HAVA DURUMU NEON YAZI STİLLERİ */
#temp {
  font-size: 4em;
  font-weight: 900;
  color: #ffffff;
  position: relative;
  z-index: 2;
  text-shadow: 
    0 0 10px #002bff,
    0 0 20px #002bff,
    0 0 30px #002bff;
  animation: neonGlow 2s ease-in-out infinite alternate;
}

#desc {
  font-size: 2.5em;
  font-weight: 700;
  color: #ffffff;
  position: relative;
  z-index: 2;
    text-shadow: 
    0 0 10px #002bff,
    0 0 20px #002bff,
    0 0 30px #002bff;
  animation: neonGlow 2s ease-in-out infinite alternate;
}

.forecast { 
  display: flex; 
  justify-content: space-around; 
  width: 100%;
  height: 40%;
  font-size: 2em;
  position: relative;
  z-index: 2;
    text-shadow: 
    0 0 10px #002bff,
    0 0 20px #002bff,
    0 0 30px #002bff;
  animation: neonGlow 2s ease-in-out infinite alternate;
}

.forecast .day { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  padding: 5px; 
}

.forecast .dayName { 
  font-weight: 700; 
  font-size: 1em; 
  margin-bottom: 3px; 
  color: #ffffff; 
}

.forecast .temp { 
  font-size: 1.1em; 
  font-weight: 700; 
  color: #ffffff; 
}

/* === SINAV GERİ SAYIM === */
#examCountdown {
  display: flex; 
  flex-direction: row;
  justify-content: space-between;
  align-items: flex-start;
  gap: 10px; 
  height: 100%;
  padding: 0 20px;
}

.countdownItem {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100%;
  position: relative;
  width: 200px;
}

.countdownItem:first-child {
  border-right: 3px solid rgba(255,255,255,0.5);
  padding-right: 20px;
}

.countdownItem:last-child {
  padding-left: 20px;
}

.countdownTitle {
  font-size: 3em;
  font-weight: 800;
  color: white;
  margin-bottom: 5px;
}

.countdownValue {
  font-size: 4em;
  font-weight: 900;
  color: #00ff00;
  animation: blink 1.5s infinite;
  margin: 2px 0;
}

.countdownLabel {
  font-size: 2em;
  font-weight: 700;
  color: white;
}

/* === YEMEK LİSTESİ === */
#menuList {
  text-align: center;
  width: 100%;
  height: 100%;
  padding: 5px;
  font-weight: 700;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  overflow: hidden;
}

.menu-row {
  width: 100%;
  margin: 0;
  padding: 2px 0;
  color: #000000;
  text-shadow: 
  0 0 5px #00ff2e,
  0 0 10px #00ff2e,
  0 0 15px #00ff2e;
  font-weight: 700;
}

.menu-row:last-child {
  border-bottom: none !important;
  margin-bottom: 0;
  padding-bottom: 0;
}

/* === MARQUEE === */
#marquee {
  flex: 0 0 auto;
  min-height: 100px;
  background: #003366;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  font-size: 5em;
  font-weight: 800;
  letter-spacing: 1px;
  position: relative;
  z-index: 1000;
}

#marquee span {
  position: absolute;
  white-space: nowrap;
  top: -10px;
  animation: scrollText 10s linear infinite;
}

/* === ANİMASYONLAR === */

/* Genel Animasyonlar */
@keyframes blink {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}

@keyframes scrollText {
  from { left: 100%; }
  to { left: -100%; }
}

@keyframes weatherIconMove {
  0%   { transform: translateY(0px); }
  50%  { transform: translateY(-10px); }
  100% { transform: translateY(0px); }
}

@keyframes weatherIconGlow {
  0%   { filter: drop-shadow(0 0 6px rgba(0, 140, 255, .5)); }
  50%  { filter: drop-shadow(0 0 22px rgba(0, 140, 255, .95)); }
  100% { filter: drop-shadow(0 0 6px rgba(0, 140, 255, .5)); }
}

/* Hava Durumu Animasyonları */
#weatherAnimation {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

/* === KAR ANİMASYONLARI === */
.snow-flake {
  position: absolute;
  top: -50px;
  background: transparent;
  pointer-events: none;
  filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.8));
}

/* Yoğun kar için */
.snow-heavy-small { width: 20px; height: 20px; animation: snow-heavy 6s linear infinite; }
.snow-heavy-medium { width: 30px; height: 30px; animation: snow-heavy 8s linear infinite; }
.snow-heavy-large { width: 40px; height: 40px; animation: snow-heavy 12s linear infinite; }

/* Hafif kar için */
.snow-light-small { width: 25px; height: 25px; animation: snow-light 15s linear infinite; }
.snow-light-medium { width: 35px; height: 35px; animation: snow-light 20s linear infinite; }
.snow-light-large { width: 45px; height: 45px; animation: snow-light 25s linear infinite; }

/* Yoğun kar animasyonu */
@keyframes snow-heavy {
  0% {
    transform: translateY(-50px) translateX(0) rotate(0deg);
    opacity: 0;
  }
  5% { opacity: 0.9; }
  95% { opacity: 0.9; }
  100% {
    transform: translateY(100vh) translateX(80px) rotate(540deg);
    opacity: 0;
  }
}

/* Hafif kar animasyonu */
@keyframes snow-light {
  0% {
    transform: translateY(-50px) translateX(-30px) rotate(0deg);
    opacity: 0;
  }
  10% { opacity: 0.7; }
  90% { opacity: 0.7; }
  100% {
    transform: translateY(100vh) translateX(30px) rotate(360deg);
    opacity: 0;
  }
}

/* Yağmur */
.rain-drop {
  position: absolute;
  top: -20px;
  background: linear-gradient(to bottom, transparent, #87CEEB);
  animation: rain-fall linear infinite;
  border-radius: 50%;
}

@keyframes rain-fall {
  0% {
    transform: translateY(-20px);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(100vh);
    opacity: 0;
  }
}

/* Güneş */
.sun-animation {
  position: absolute;
  top: 20px;
  right: 20px;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle, #FFD700, #FFA500);
  border-radius: 50%;
  animation: sun-pulse 3s ease-in-out infinite;
  box-shadow: 0 0 20px #FFD700, 0 0 40px #FFA500;
}

@keyframes sun-pulse {
  0%, 100% {
    transform: scale(1);
    opacity: 0.8;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
}

/* Bulut */
.cloud-img {
  position: absolute;
  width: 100px;
  height: auto;
  opacity: 0.8;
  animation: cloud-move linear infinite;
}

@keyframes cloud-move {
  0% { transform: translateX(-150px); }
  100% { transform: translateX(110vw); }
}

/* Sis */
.fog {
  position: absolute;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.1),
    transparent
  );
  animation: fog-move 10s linear infinite;
}

@keyframes fog-move {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

/* === RESPONSIVE TASARIM === */
@media (max-width: 768px) and (orientation: landscape) {
  main {
    grid-template-columns: repeat(4, minmax(200px, 1fr));
    grid-template-rows: auto;
    gap: 10px;
  }
  
  #websiteBox, #weatherBox, #solkutu, #menuBox, #examCountdown, #nobetci {
    width: 220px;
  }
}

@media (max-width: 1024px) and (orientation: landscape) {
  body {
    overflow-x: hidden;
  }

  main {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    grid-auto-rows: minmax(120px, auto);
    gap: 10px;
    width: 100%;
  }

  #websiteBox, #weatherBox, #solkutu, #menuBox, #examCountdown, #nobetci {
    min-width: 0;
    width: 100%;
  }
}

/* GİZLİ BAŞLIKLAR */
#solkutu .boxTitle {
  display: none;
}
</style>
</head>
<body>
<header>
  <div id="headerLeft">FATİH MEHMET ALDEMİR<br>PANOSU</div>
  <div id="headerCenter"><img src="okul_logo.png" alt="Okul Logosu" id="schoolLogo"></div>
  <div id="headerRight">
    <span id="dayMonth"></span>
    <span id="time"></span>
  </div>
</header>

<main>
  <!-- 1. SATIR -->
  <div class="box" id="nobetci">
    <div class="boxTitle">NÖBETÇİ ÖĞRETMENLER</div>
    <div id="nobetciList">Yükleniyor...</div>
  </div>

  <!-- WEB SİTESİ KUTUSU -->
  <div class="box" id="websiteBox">
    <div id="iframeWrapper">
      <iframe id="webFrame" src="https://develiihl.meb.k12.tr/"></iframe>
    </div>
  </div>

  <!-- 2. SATIR -->
  <div class="box" id="examCountdown">
    <div class="countdownItem">
      <div class="countdownTitle">YKS</div>
      <div class="countdownValue" id="yksCountdownNum">--</div>
      <div class="countdownLabel">GÜN</div>
      <div class="countdownValue" id="yksCountdownHour">--</div>
      <div class="countdownLabel">SAAT</div>
    </div>
    <div class="countdownItem">
      <div class="countdownTitle">LGS</div>
      <div class="countdownValue" id="lgsCountdownNum">--</div>
      <div class="countdownLabel">GÜN</div>
      <div class="countdownValue" id="lgsCountdownHour">--</div>
      <div class="countdownLabel">SAAT</div>
    </div>
  </div>

  <div class="box" id="weatherBox">
    <div class="boxTitle">HAVA DURUMU</div>
    <div id="weatherAnimation"></div>
    <div id="currentWeather">
      <img id="weatherIcon" src="" alt="icon">
      <div>
        <div id="temp">--°C</div>
        <div id="desc">Yükleniyor...</div>
      </div>
    </div>
    <div class="forecast">
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
      <div class="day"><div class="dayName">--</div><div class="temp">--°C</div></div>
    </div>
  </div>

  <!-- 3. SATIR -->
  <div class="box" id="solkutu">
    <div id="box1Content">Yükleniyor...</div>
  </div>

  <div class="box" id="menuBox">
    <div class="boxTitle">YEMEK LİSTESİ</div>
    <div id="menuList">Yükleniyor...</div>
  </div>
</main>

<!-- Marquee -->
<div id="marquee"><span>HOŞ GELDİNİZ</span></div>

<script>
// === METİN SIKIŞTIRMA FONKSİYONLARI ===
function fitTextToBox() {
  const container = document.getElementById("box1Content");
  const maxHeight = container.clientHeight;
  const maxWidth = container.clientWidth;

  let fontSize = 10;
  container.style.fontSize = fontSize + "px";

  while(container.scrollHeight <= maxHeight && container.scrollWidth <= maxWidth && fontSize < 200) {
    fontSize += 1;
    container.style.fontSize = fontSize + "px";
  }

  container.style.fontSize = (fontSize - 1) + "px";
}

function fitMenuText() {
  const container = document.getElementById("menuList");
  const maxHeight = container.clientHeight;
  const maxWidth = container.clientWidth;

  let fontSize = 10;
  container.style.fontSize = fontSize + "px";

  while(container.scrollHeight <= maxHeight && container.scrollWidth <= maxWidth && fontSize < 200) {
    fontSize += 1;
    container.style.fontSize = fontSize + "px";
  }

  container.style.fontSize = (fontSize - 1) + "px";
}

// === TAM EKRAN ===
function enableFullScreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
}
window.addEventListener("click", enableFullScreen);

// === TARİH & SAAT ===
function updateDateTime() {
  const now = new Date();
  const days = ["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"];
  const months = ["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım"];
  
  const dayName = days[now.getDay()];
  const dateNum = now.getDate();
  const monthName = months[now.getMonth()];
  const hours = now.getHours().toString().padStart(2,"0");
  const minutes = now.getMinutes().toString().padStart(2,"0");
  
  document.getElementById("dayMonth").innerText = `${dayName}, ${dateNum} ${monthName}`;
  document.getElementById("time").innerText = `${hours}:${minutes}`;
}
setInterval(updateDateTime, 1000);
updateDateTime();

// === SINAV GERİ SAYIM ===
function countdown(target, numEl, hourEl) {
  const now = new Date();
  const diff = target - now;
  
  if (diff <= 0) {
    document.getElementById(numEl).innerText = "0";
    document.getElementById(hourEl).innerText = "0";
    return;
  }
  
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  
  document.getElementById(numEl).innerText = days;
  document.getElementById(hourEl).innerText = hours;
}

// DOMContentLoaded içinde kullanın:
setInterval(()=>{
  // YKS: 20 Haziran 2026 saat 10:30
  countdown(new Date("2026-06-20T10:30:00"), "yksCountdownNum","yksCountdownHour");
  // LGS: 14 Haziran 2026 saat 09:30
  countdown(new Date("2026-06-14T09:30:00"), "lgsCountdownNum","lgsCountdownHour");
}, 1000);
// === HAVA DURUMU ANİMASYON SİSTEMİ ===
class WeatherAnimation {
  constructor() {
    this.container = document.getElementById('weatherAnimation');
    this.currentWeather = '';
  }

  setWeather(weatherType) {
    this.clearAnimation();
    this.currentWeather = weatherType.toLowerCase();
    
    switch(this.currentWeather) {
      case 'rain':
      case 'heavy rain':
        this.createHeavyRain();
        break;
      case 'light rain':
      case 'drizzle':
        this.createLightRain();
        break;
      case 'snow':
        this.createHeavySnow();
        break;
      case 'light snow':
        this.createLightSnow();
        break;
      case 'clear':
        this.createSunny();
        break;
      case 'few clouds':
        this.createFewClouds();
        break;
      case 'scattered clouds':
      case 'cloudy':
        this.createCloudy();
        break;
      case 'fog':
      case 'mist':
      case 'haze':
        this.createFog();
        break;
      case 'thunderstorm':
        this.createThunderstorm();
        break;
      default:
        this.createCloudy();
    }
  }

  // YOĞUN YAĞMUR
  createHeavyRain() {
    for (let i = 0; i < 150; i++) {
      const drop = document.createElement('div');
      drop.className = 'rain-drop';
      drop.style.left = `${Math.random() * 100}%`;
      drop.style.animationDuration = `${0.3 + Math.random() * 0.5}s`;
      drop.style.animationDelay = `${Math.random() * 1}s`;
      drop.style.width = '3px';
      drop.style.height = '25px';
      this.container.appendChild(drop);
    }
  }

  // HAFİF YAĞMUR
  createLightRain() {
    for (let i = 0; i < 50; i++) {
      const drop = document.createElement('div');
      drop.className = 'rain-drop';
      drop.style.left = `${Math.random() * 100}%`;
      drop.style.animationDuration = `${1 + Math.random() * 2}s`;
      drop.style.animationDelay = `${Math.random() * 3}s`;
      drop.style.width = '2px';
      drop.style.height = '15px';
      drop.style.opacity = '0.6';
      this.container.appendChild(drop);
    }
  }

  // YOĞUN KAR YAĞIŞI
  createHeavySnow() {
    const heavySnowTypes = [
      { class: 'snow-heavy-small', count: 25 },
      { class: 'snow-heavy-medium', count: 20 },
      { class: 'snow-heavy-large', count: 15 }
    ];

    heavySnowTypes.forEach(type => {
      for (let i = 0; i < type.count; i++) {
        const snow = document.createElement('img');
        snow.className = `snow-flake ${type.class}`;
        snow.src = 'icons/weather/AnimasyonKAR.png';
        snow.alt = 'Kar tanesi';
        
        snow.style.left = `${Math.random() * 100}%`;
        snow.style.animationDuration = `${4 + Math.random() * 4}s`;
        snow.style.animationDelay = `${Math.random() * 2}s`;
        
        this.container.appendChild(snow);
      }
    });
  }

  // HAFİF KAR YAĞIŞI
  createLightSnow() {
    const lightSnowTypes = [
      { class: 'snow-light-small', count: 8 },
      { class: 'snow-light-medium', count: 6 },
      { class: 'snow-light-large', count: 4 }
    ];

    lightSnowTypes.forEach(type => {
      for (let i = 0; i < type.count; i++) {
        const snow = document.createElement('img');
        snow.className = `snow-flake ${type.class}`;
        snow.src = 'icons/weather/AnimasyonKAR.png';
        snow.alt = 'Kar tanesi';
        
        snow.style.left = `${Math.random() * 100}%`;
        snow.style.animationDuration = `${12 + Math.random() * 10}s`;
        snow.style.animationDelay = `${Math.random() * 5}s`;
        
        this.container.appendChild(snow);
      }
    });
  }

  createSunny() {
    const sun = document.createElement('div');
    sun.className = 'sun-animation';
    this.container.appendChild(sun);
  }

  // AZ BULUTLU
  createFewClouds() {
    for (let i = 0; i < 2; i++) {
      const cloud = document.createElement('img');
      cloud.src = 'icons/weather/bulutanimasyon.png';
      cloud.className = 'cloud-img';
      cloud.style.top = `${30 + Math.random() * 30}%`;
      cloud.style.width = `${80 + Math.random() * 40}px`;
      cloud.style.animationDuration = `${60 + Math.random() * 40}s`;
      cloud.style.animationDelay = `${Math.random() * 10}s`;
      cloud.style.opacity = '0.4';
      this.container.appendChild(cloud);
    }
    this.createSunny();
  }

  // ÇOK BULUTLU
  createCloudy() {
    for (let i = 0; i < 5; i++) {
      const cloud = document.createElement('img');
      cloud.src = 'icons/weather/bulutanimasyon.png';
      cloud.className = 'cloud-img';
      cloud.style.top = `${20 + Math.random() * 50}%`;
      cloud.style.width = `${150 + Math.random() * 100}px`;
      cloud.style.animationDuration = `${40 + Math.random() * 30}s`;
      cloud.style.animationDelay = `${Math.random() * 10}s`;
      this.container.appendChild(cloud);
    }
  }

  createFog() {
    const fog = document.createElement('div');
    fog.className = 'fog';
    this.container.appendChild(fog);
  }

  createThunderstorm() {
    this.createHeavyRain();
    setInterval(() => {
      if (Math.random() > 0.7) {
        this.container.style.backgroundColor = 'rgba(255, 255, 255, 0.3)';
        setTimeout(() => {
          this.container.style.backgroundColor = 'transparent';
        }, 100);
      }
    }, 2000);
  }

  clearAnimation() {
    this.container.innerHTML = '';
    this.container.style.backgroundColor = 'transparent';
  }
}

const weatherAnim = new WeatherAnimation();

// === DETAYLI HAVA DURUMU VERİSİ ===
async function loadWeather() {
  const apiKey = "c5155ad22a417a8b1068985b43425bb3";
  const city = "Develi,TR";

  try {
    const currentRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=tr`);
    const currentData = await currentRes.json();
    
    const temp = Math.round(currentData.main.temp);
    const weatherMain = currentData.weather[0].main;
    const weatherDesc = currentData.weather[0].description.toLowerCase();
    const clouds = currentData.clouds.all;

    // Detaylı hava durumu tespiti
    let displayDesc = "";
    let weatherType = "";

    // YAĞMUR DURUMLARI
    if (weatherMain === "Rain") {
      if (weatherDesc.includes("hafif") || weatherDesc.includes("light") || weatherDesc.includes("çisenti")) {
        displayDesc = "HAFİF YAĞMUR";
        weatherType = "light rain";
      } else if (weatherDesc.includes("şiddetli") || weatherDesc.includes("heavy")) {
        displayDesc = "YOĞUN YAĞMUR";
        weatherType = "heavy rain";
      } else {
        displayDesc = "YAĞMURLU";
        weatherType = "rain";
      }
    }
    // KAR DURUMLARI
    else if (weatherMain === "Snow") {
      if (weatherDesc.includes("hafif") || weatherDesc.includes("light")) {
        displayDesc = "HAFİF KAR";
        weatherType = "light snow";
      } else {
        displayDesc = "YOĞUN KAR";
        weatherType = "snow";
      }
    }
    // BULUT DURUMLARI
    else if (weatherMain === "Clouds") {
      if (clouds < 50) {
        displayDesc = "AZ BULUTLU";
        weatherType = "few clouds";
      } else if (clouds < 85) {
        displayDesc = "PARÇALI BULUTLU";
        weatherType = "scattered clouds";
      } else {
        displayDesc = "ÇOK BULUTLU";
        weatherType = "cloudy";
      }
    }
    // DİĞER DURUMLAR
    else if (weatherMain === "Clear") {
      displayDesc = "AÇIK";
      weatherType = "clear";
    }
    else if (weatherMain === "Thunderstorm") {
      displayDesc = "GÖKGÜRÜLTÜLÜ";
      weatherType = "thunderstorm";
    }
    else if (weatherMain === "Drizzle") {
      displayDesc = "ÇİSENTİ";
      weatherType = "drizzle";
    }
    else if (weatherMain === "Mist" || weatherMain === "Fog" || weatherMain === "Haze") {
      displayDesc = "SİSLİ";
      weatherType = "fog";
    }
    else {
      displayDesc = currentData.weather[0].description.toUpperCase();
      weatherType = weatherMain.toLowerCase();
    }

    // Bilgileri göster
    document.getElementById("temp").innerText = temp + "°C";
    document.getElementById("desc").innerText = displayDesc;

    // İkonu ayarla
    const iconMap = {
      'clear': 'sunny.png',
      'few clouds': 'cloudy.png',
      'scattered clouds': 'cloudy.png',
      'cloudy': 'cloudy.png',
      'rain': 'rainy.png',
      'light rain': 'rainy.png',
      'heavy rain': 'rainy.png',
      'snow': 'snowy.png',
      'light snow': 'snowy.png',
      'thunderstorm': 'thunderstorm.png',
      'drizzle': 'rainy.png',
      'fog': 'cloudy.png'
    };

    document.getElementById("weatherIcon").src = "icons/weather/" + (iconMap[weatherType] || "cloudy.png");

    // Animasyonu başlat
    weatherAnim.setWeather(weatherType);

    // 3 GÜNLÜK TAHMİN
    const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric&lang=tr`);
    const forecastData = await forecastRes.json();
    
    const daysMap = ["Paz", "Pzt", "Sal", "Çar", "Per", "Cum", "Cts"];
    const dailyForecast = [];
    const addedDates = new Set();

    for (let item of forecastData.list) {
      const date = new Date(item.dt_txt);
      const dateKey = date.toDateString();
      
      if (!addedDates.has(dateKey)) {
        addedDates.add(dateKey);
        dailyForecast.push({
          dayName: daysMap[date.getDay()],
          temp: Math.round(item.main.temp)
        });
      }
      if (dailyForecast.length >= 3) break;
    }

    const forecastContainer = document.querySelector("#weatherBox .forecast");
    forecastContainer.innerHTML = dailyForecast.map(d => `
      <div class="day">
        <div class="dayName">${d.dayName}</div>
        <div class="temp">${d.temp}°C</div>
      </div>
    `).join("");

  } catch (error) {
    console.error("Hava durumu hatası:", error);
    document.getElementById("temp").innerText = "--";
    document.getElementById("desc").innerText = "❌ Veri alınamadı";
    weatherAnim.setWeather('cloudy');
  }
}

function updateWeatherHourly() {
  const now = new Date();
  const delay = (60 - now.getMinutes())*60*1000 - now.getSeconds()*1000;
  setTimeout(() => {
    loadWeather();
    setInterval(loadWeather, 3600000);
  }, delay);
}
loadWeather();
updateWeatherHourly();

// === NÖBETÇİ ÖĞRETMEN ===
const sheetURL = "https://docs.google.com/spreadsheets/d/1oF2cT3UkMBW4c2PgVIsncCYfHV1dJeoB_fS68c8pU1c/gviz/tq?tqx=out:json&gid=0";

function loadDutyTeachers() {
  fetch(sheetURL)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1));
      const rows = json.table.rows;

      const days = [null,"PAZARTESİ","SALI","ÇARŞAMBA","PERŞEMBE","CUMA",null];
      const today = days[new Date().getDay()];

      const headers = rows[0].c.map(h => h?.v?.toString().toUpperCase() || "");
      const colIndex = headers.indexOf(today);
      if(colIndex === -1) {
        document.getElementById("nobetciList").innerHTML = "dyk";
        return;
      }

      let output = "";

      for (let i = 1; i < rows.length; i++) {
        const place = rows[i].c[0]?.v || "";
        const teacherCell = rows[i].c[colIndex]?.v || "";
        if (!place && !teacherCell) continue;

        const teachers = teacherCell.split("\n").filter(t => t.trim() !== "");

        output += `<div class="nobetRow">`;
        if(place) output += `<span class="nobetPlace">${place}:</span> `;
        if(teachers.length) {
          output += `<span class="nobetTeacher">`;
          teachers.forEach(t => {
            output += `${t}<br>`;
          });
          output += `</span>`;
        }
        output += `</div>`;
      }

      document.getElementById("nobetciList").innerHTML = output || "BUGÜN NÖBET YOK";
    })
    .catch(err => {
      console.error(err);
      document.getElementById("nobetciList").innerHTML = "❌ Veri alınamadı";
    });
}

loadDutyTeachers();
setInterval(loadDutyTeachers, 30000);

// === YEMEK LİSTESİ ===
const menuSheetURL="https://docs.google.com/spreadsheets/d/1ps4RgDTOscAE8FVLU0mWl9hJpnK2XEMlHa8C7c7e9pw/gviz/tq?tqx=out:json&gid=0";

function loadMenu(){
  const menuListElement = document.getElementById("menuList");
  const now = new Date();
  const year = now.getFullYear();
  const month = (now.getMonth() + 1).toString().padStart(2, "0");
  const day = now.getDate().toString().padStart(2, "0");
  
  const todayDateString = `${day}.${month}.${year}`;

  fetch(menuSheetURL)
    .then(res => res.text())
    .then(text => {
      const jsonText = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
      const json = JSON.parse(jsonText);
      const rows = json.table.rows;
      
      let output = "Bu güne ait yemek listesi yok.";
      let found = false;

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i].c;
        const sheetDateCell = row[0]?.f || row[0]?.v;
        
        if (!sheetDateCell) continue;
        
        let sheetDateString = null;

        if (typeof sheetDateCell === 'string' && sheetDateCell.startsWith('Date(')) {
          const parts = sheetDateCell.match(/\d+/g);
          if (parts && parts.length >= 3) {
            const sheetYear = parts[0];
            const sheetMonth = (parseInt(parts[1]) + 1).toString().padStart(2, "0");
            const sheetDay = parts[2].toString().padStart(2, "0");
            sheetDateString = `${sheetDay}.${sheetMonth}.${sheetYear}`;
          }
        } else if (typeof sheetDateCell === 'string') {
          sheetDateString = sheetDateCell.trim();
        }

        if (sheetDateString === todayDateString) {
          output = row[1]?.v || "Yemek listesi boş.";
          found = true;
          break;
        }
      }
      
      if (found && output !== "Yemek listesi boş.") {
        const foods = output.split("\n").filter(food => food.trim() !== "");
        let formattedOutput = '';
        
        foods.forEach((food, index) => {
          const isLast = index === foods.length - 1;
          formattedOutput += `<div class="menu-row">${food}</div>`;
        });
        
        menuListElement.innerHTML = formattedOutput;
        fitMenuText(); 
      } else {
        menuListElement.innerHTML = `<div class="menu-row">${output}</div>`;
        fitMenuText();
      }
    })
    .catch(err => {
      console.error("Yemek Listesi Hatası:", err);
      menuListElement.innerHTML = '<div class="menu-row" style="border-bottom: 3px solid red;">❌ Yemek listesi alınamadı</div>';
    });
}

loadMenu();
setInterval(loadMenu, 3600000);

// === GÜNLÜK SÖZLER ===
const quoteSheetURL = "https://docs.google.com/spreadsheets/d/1p4pq-wpK-oFzufueyKOTmYi_Ic2iVcVTyyhXbfpzBhE/gviz/tq?tqx=out:json&gid=0"; 

function loadDailyQuote() {
  const solKutuElement = document.getElementById("box1Content");
  const now = new Date();
  const year = now.getFullYear();
  const month = (now.getMonth() + 1).toString().padStart(2, "0");
  const day = now.getDate().toString().padStart(2, "0");
  
  const todayDateString = `${day}.${month}.${year}`;

  fetch(quoteSheetURL)
    .then(res => res.text())
    .then(text => {
      const jsonText = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
      const json = JSON.parse(jsonText);
      const rows = json.table.rows;
      
      let quote = "Bu güne ait ilham verici söz yok.";

      for (let i = 0; i < rows.length; i++) {
        const row = rows[i].c;
        const sheetDateCell = row[0]?.f || row[0]?.v;
        
        if (!sheetDateCell) continue;
        
        let sheetDateString = null;

        if (typeof sheetDateCell === 'string' && sheetDateCell.startsWith('Date(')) {
          const parts = sheetDateCell.match(/\d+/g);
          if (parts && parts.length >= 3) {
            const sheetYear = parts[0];
            const sheetMonth = (parseInt(parts[1]) + 1).toString().padStart(2, "0");
            const sheetDay = parts[2].toString().padStart(2, "0");
            sheetDateString = `${sheetDay}.${sheetMonth}.${sheetYear}`;
          }
        } else if (typeof sheetDateCell === 'string') {
          sheetDateString = sheetDateCell.trim();
        }

        if (sheetDateString === todayDateString) {
          quote = row[1]?.v || "Söz listesi boş.";
          break;
        }
      }
      
      solKutuElement.innerHTML = quote.split("\n").join("<br>");
      fitTextToBox();
    })
    .catch(err => {
      console.error("Günlük Söz Hatası:", err);
      solKutuElement.innerHTML = "❌ Günlük söz alınamadı";
    });
}

loadDailyQuote();
setInterval(loadDailyQuote, 3600000);

// === EVENT LISTENERS ===
window.addEventListener("resize", fitTextToBox);
window.addEventListener("resize", fitMenuText);
</script>
</body>
</html>
